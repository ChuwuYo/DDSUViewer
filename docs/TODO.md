# DDSUViewer 开发任务清单

## 🏗️ 项目基础设置

- [ ] 升级前端依赖到最新版本
  - [ ] React 18.3.1 + React DOM
  - [ ] TypeScript 5.5.4
  - [ ] Vite 构建工具配置
- [ ] 集成 Hero UI 组件库
  - [ ] 安装 @heroui/react
  - [ ] 配置 HeroUIProvider
  - [ ] 添加基础组件 (Card, Input, Table)
- [ ] 集成 GraphQL 客户端
  - [ ] 安装 Apollo Client 或 urql
  - [ ] 配置 GraphQL 客户端连接

## 🔌 后端核心模块开发

### 串口通信模块 (serial)
- [ ] 实现串口基础操作
  - [ ] 串口打开/关闭
  - [ ] 参数配置 (9600 8N1)
  - [ ] 读写操作封装
- [ ] 串口互斥访问控制
- [ ] 串口状态监控

### Modbus RTU 协议模块 (modbus)
- [ ] 实现 Modbus RTU 帧构造
  - [ ] 0x03 读寄存器帧
  - [ ] 0x10 写多寄存器帧
- [ ] CRC16 校验算法实现
- [ ] 帧解析与验证
- [ ] 异常响应处理 (0x83/0x90)

### 寄存器映射模块 (registers)
- [ ] 定义数据点寄存器映射
  - [ ] 电压 U (0x2000)
  - [ ] 电流 I (0x2002)
  - [ ] 有功功率 P (0x2004)
  - [ ] 无功功率 Q (0x2006)
  - [ ] 视在功率 S (0x2008)
  - [ ] 功率因数 PF (0x200A)
  - [ ] 频率 Freq (0x200E)
  - [ ] 有功总电能 Ep (0x4000)
- [ ] IEEE754 浮点数解析
- [ ] 数据类型转换与校验

### 协议探测模块 (protocol_detector)
- [ ] Modbus RTU 协议探测
- [ ] DL/T645 协议探测
- [ ] 协议自动识别逻辑
- [ ] 协议切换提示

### 轮询调度模块 (poller)
- [ ] 实现周期性数据轮询
  - [ ] 电参量 1秒周期轮询
  - [ ] 电能 5-10秒周期轮询
- [ ] 合并读取优化 (连续寄存器)
- [ ] 超时重试机制 (100-300ms, 2-3次)
- [ ] 多从站轮询调度

### 数据解析模块 (parser)
- [ ] 浮点数据解析
- [ ] 异常数据过滤 (NaN/Inf)
- [ ] 数据跳变检测
- [ ] 端序校准处理

## 🌐 GraphQL 接口开发

### Schema 定义
- [ ] 定义 GraphQL Schema
  - [ ] Query 类型 (读取数据)
  - [ ] Mutation 类型 (配置修改)
  - [ ] Subscription 类型 (实时推送)
- [ ] 数据类型定义
  - [ ] 电参量数据类型
  - [ ] 串口配置类型
  - [ ] 设备状态类型

### Resolver 实现
- [ ] Query Resolver
  - [ ] 获取实时电参量数据
  - [ ] 获取设备连接状态
  - [ ] 获取串口配置
- [ ] Mutation Resolver
  - [ ] 修改串口参数
  - [ ] 启动/停止数据采集
  - [ ] 设备配置写入
- [ ] Subscription Resolver
  - [ ] 实时数据推送
  - [ ] 状态变化通知

### 实时推送系统 (pubsub)
- [ ] WebSocket 连接管理
- [ ] 订阅者管理
- [ ] 数据广播机制
- [ ] 连接异常处理

## 🎨 前端界面开发

### 主界面布局
- [ ] 应用主框架搭建
- [ ] 导航栏设计
- [ ] 响应式布局适配

### 实时数据展示页面
- [ ] 电参量数据卡片
  - [ ] 电压显示卡片
  - [ ] 电流显示卡片
  - [ ] 功率显示卡片 (有功/无功/视在)
  - [ ] 功率因数显示卡片
  - [ ] 频率显示卡片
  - [ ] 电能显示卡片
- [ ] 数据实时更新
- [ ] 数值格式化显示

### 串口配置界面
- [ ] 串口参数配置表单
  - [ ] 波特率选择
  - [ ] 数据位配置
  - [ ] 停止位配置
  - [ ] 从站地址设置
- [ ] 串口自动扫描功能
- [ ] 配置保存与应用

### 状态监控界面
- [ ] 连接状态指示器
- [ ] 协议识别状态显示
- [ ] 通信质量监控
- [ ] 数据刷新延迟显示

### 错误提示系统
- [ ] 顶部错误提示组件
- [ ] CRC 错误提示
- [ ] 超时错误提示
- [ ] 设备异常提示
- [ ] 协议不匹配提示

## 🔗 Wails 桌面集成

### 方法绑定
- [ ] 后端方法暴露
- [ ] 前端 TypeScript API 生成
- [ ] 统一调用层封装
- [ ] 异常处理机制

### 应用配置
- [ ] Wails 配置文件优化
- [ ] 窗口属性设置
- [ ] 图标和资源配置
- [ ] 构建脚本优化

## 🧪 测试与优化

### 功能测试
- [ ] 串口通信测试
- [ ] Modbus 协议测试
- [ ] 数据解析测试
- [ ] 界面交互测试

### 性能优化
- [ ] 内存使用优化
- [ ] CPU 占用优化
- [ ] 通信效率优化
- [ ] 界面渲染优化

### 稳定性测试
- [ ] 长时间运行测试
- [ ] 异常情况处理测试
- [ ] 资源清理测试
- [ ] 多设备连接测试

## 📦 部署与发布

- [ ] 构建脚本完善
- [ ] 安装包制作
- [ ] 用户文档编写
- [ ] 版本发布准备

---

**说明**: 
- 每完成一个任务，请在对应的 `[ ]` 中打勾 `[x]`
- 任务按模块和优先级排序，建议按顺序执行
- 遇到问题时可参考 docs 文件夹中的技术文档