# DDSUViewer 开发任务清单

## 🏗️ 项目基础设置

- [x] 升级前端依赖到最新版本
  - [x] React 18.3.1 + React DOM
  - [x] TypeScript 5.5.4
  - [x] Vite 构建工具配置
- [x] 集成 Chakra UI 组件库
  - [x] 安装 @chakra-ui/react
  - [x] 配置 ChakraProvider
  - [x] 添加基础组件 (Card, Input, Select, Button)
- [x] 集成 GraphQL 客户端
  - [x] 安装 Apollo Client
  - [x] 配置 GraphQL 客户端连接
  - [x] 创建 GraphQL 查询和变更

## 🔌 后端核心模块开发

### 串口通信模块 (serial)
- [x] 实现串口基础操作
  - [x] 串口打开/关闭
  - [x] 参数配置 (9600 8N1)
  - [x] 读写操作封装
- [x] 串口互斥访问控制
- [x] 串口状态监控

### Modbus RTU 协议模块 (modbus)
- [x] 实现 Modbus RTU 帧构造
  - [x] 0x03 读寄存器帧
- [x] CRC16 校验算法实现
- [x] 帧解析与验证


### 寄存器映射模块 (registers)
- [x] 定义数据点寄存器映射
  - [x] 电压 U (0x2000)
  - [x] 电流 I (0x2002)
  - [x] 有功功率 P (0x2004)
  - [x] 无功功率 Q (0x2006)
  - [x] 视在功率 S (0x2008)
  - [x] 功率因数 PF (0x200A)
  - [x] 频率 Freq (0x200E)
  - [x] 有功总电能 Ep (0x4000)
- [x] IEEE754 浮点数解析
- [x] 数据类型转换与校验

### 协议探测模块 (protocol_detector)
- [x] Modbus RTU 协议探测
- [x] 基础连接测试

### 轮询调度模块 (poller)
- [x] 实现周期性数据轮询
  - [x] 电参量 1秒周期轮询
  - [x] 电能 5-10秒周期轮询
- [x] 合并读取优化 (连续寄存器)
- [x] 超时重试机制 (100-300ms, 2-3次)

### 数据解析模块 (parser)
- [x] 浮点数据解析
- [x] 异常数据过滤 (NaN/Inf)

## 🌐 GraphQL 接口开发

### Schema 定义
- [x] 定义 GraphQL Schema
  - [x] Query 类型 (读取数据)
  - [x] Mutation 类型 (配置修改)
  - [x] Subscription 类型 (实时推送)
- [x] 数据类型定义
  - [x] 电参量数据类型
  - [x] 串口配置类型
  - [x] 设备状态类型

### Resolver 实现
- [x] Query Resolver
  - [x] 获取实时电参量数据
  - [x] 获取设备连接状态
  - [x] 获取串口配置
- [x] Mutation Resolver
  - [x] 修改串口参数
  - [x] 启动/停止数据采集
- [x] Subscription Resolver
  - [x] 实时数据推送
  - [x] 状态变化通知

### 实时推送系统 (pubsub)
- [x] WebSocket 连接管理
- [x] 订阅者管理
- [x] 数据广播机制
- [x] 连接异常处理

## 🎨 前端界面开发（能用Chakra - UI 已有组件就用）

### 主界面布局
- [x] 应用主框架搭建

### 实时数据展示页面
- [x] 电参量数据卡片
  - [x] 电压显示卡片
  - [x] 电流显示卡片
  - [x] 功率显示卡片 (有功/无功/视在)
  - [x] 功率因数显示卡片
  - [x] 频率显示卡片
  - [x] 电能显示卡片
- [x] 数据实时更新
- [x] 数值格式化显示

### 串口配置界面
- [x] 串口参数下拉框配置
  - [x] COM 端口下拉框（枚举 Windows 已连接设备）
  - [x] 手动输入从站地址（为空时提示用户）
  - [x] 波特率下拉框（4800, 9600, 19200, 38400, 115200）
  - [x] 数据位下拉框（7, 8）
  - [x] 停止位下拉框（1, 2）
  - [x] 校验位下拉框（None, Even, Odd）
- [x] Hex发送按钮（控制发送数据格式）
- [x] Hex显示按钮（控制接收数据显示格式）
- [x] Windows COM 端口枚举功能


### 状态监控界面
- [x] 连接状态指示器
- [x] 协议识别状态显示

### 错误提示系统
- [x] 基础错误提示组件
- [x] 连接失败提示
- [x] 数据异常提示
- [x] 从站地址为空提示

## 🔗 Wails 桌面集成

### 方法绑定
- [ ] 后端方法暴露
- [ ] 前端 TypeScript API 生成
- [ ] 统一调用层封装
- [ ] 异常处理机制

### 应用配置
- [ ] Wails 配置文件优化
- [ ] 窗口属性设置
- [ ] 图标和资源配置
- [ ] 构建脚本优化

## 🧪 基础测试

- [x] 串口通信测试
- [ ] 数据读取测试
- [x] 界面功能测试

## 📦 构建

- [ ] 构建脚本完善

---

**说明**: 
- 每完成一个任务，请在对应的 `[ ]` 中打勾 `[x]`
- 任务按模块和优先级排序，建议按顺序执行
- 遇到问题时可参考 docs 文件夹中的技术文档