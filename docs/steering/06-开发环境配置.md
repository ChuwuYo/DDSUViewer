# DDSUViewer 开发环境配置

## 环境要求

### 系统要求
- **操作系统**: Windows 10/11 (64位)
- **内存**: 最少 4GB RAM，推荐 8GB+
- **存储**: 至少 2GB 可用空间
- **网络**: 用于下载依赖包

### 硬件要求
- **串口**: RS485 串口或 USB 转 RS485 适配器
- **设备**: DDSU666 单相电子式电能表
- **连接线**: RS485 通信线缆

## 开发工具安装

### 1. Go 语言环境

#### 下载安装
```bash
# 访问官网下载 Go 1.23+
https://golang.org/dl/

# 或使用包管理器 (Windows)
winget install GoLang.Go

# 验证安装
go version
```

#### 环境变量配置
```bash
# 设置 GOPROXY (加速国内下载)
go env -w GOPROXY=https://goproxy.cn,direct
go env -w GOSUMDB=sum.golang.google.cn

# 启用模块支持
go env -w GO111MODULE=on
```

### 2. Node.js 环境

#### 下载安装
```bash
# 访问官网下载 Node.js 16+
https://nodejs.org/

# 或使用包管理器
winget install OpenJS.NodeJS

# 验证安装
node --version
npm --version
```

#### NPM 配置
```bash
# 设置国内镜像源
npm config set registry https://registry.npmmirror.com

# 或使用 yarn
npm install -g yarn
yarn config set registry https://registry.npmmirror.com
```

### 3. Wails CLI 工具

#### 安装 Wails
```bash
# 安装 Wails CLI
go install github.com/wailsapp/wails/v2/cmd/wails@latest

# 验证安装
wails version

# 检查依赖
wails doctor
```

#### Wails 依赖检查
```bash
# 运行依赖检查，确保所有工具已安装
wails doctor

# 输出示例:
# ✓ Go version: go1.23.0
# ✓ Node.js version: v18.17.0
# ✓ npm version: 9.6.7
# ✓ Wails version: v2.10.2
```

### 4. 开发工具推荐

#### VS Code 配置
``json
// .vscode/settings.json
{
  "go.toolsEnvVars": {
    "GO111MODULE": "on",
    "GOPROXY": "https://goproxy.cn,direct"
  },
  "go.useLanguageServer": true,
  "go.lintTool": "golangci-lint"
}
```

#### VS Code 推荐插件
1. Go - Go语言支持
2. TypeScript Importer - TypeScript自动导入
3. ES7+ React/Redux/React-Native snippets - React代码片段
4. Auto Rename Tag - HTML标签自动重命名
5. Bracket Pair Colorizer - 括号配对高亮
6. GitLens - Git增强工具

## 项目初始化

### 1. 克隆项目
```bash
git clone https://github.com/ChuwuYo/DDSUViewer.git
cd DDSUViewer
```

### 2. 安装后端依赖
```bash
# 安装 Go 模块依赖
go mod tidy
```

### 3. 安装前端依赖
```bash
# 进入前端目录并安装依赖
cd frontend
npm install
cd ..
```

### 4. 验证环境
```bash
# 检查 Go 依赖
go list -m all

# 检查前端依赖
cd frontend
npm list
cd ..
```

## 开发模式运行

### 启动开发服务器
```bash
# 在项目根目录运行
wails dev
```

**功能特点**:
- 热重载: 前端代码修改后自动刷新
- 实时构建: Go代码修改后自动重新编译
- 调试支持: 支持前后端调试
- 日志输出: 实时显示应用日志

## 构建生产版本

### 标准构建
```bash
# 构建生产版本
wails build
```

### 带版本号构建
```bash
# 带版本号构建
wails build -ldflags="-X main.Version=1.0.0"
```

### 压缩构建
```bash
# 压缩构建
wails build -ldflags="-s -w" -upx
```

### 构建输出
构建完成后，可执行文件位于 `build/bin/DDSUViewer.exe`

## 常见问题解决

### 1. 串口权限问题
```bash
# Windows 系统通常不需要特殊权限配置
# 如果遇到串口访问问题，请确保:
# 1. 使用管理员权限运行应用
# 2. 没有其他程序占用串口
# 3. 串口驱动已正确安装
```

### 2. 依赖下载失败
```bash
# 清理并重新下载依赖
go clean -modcache
go mod tidy
```

### 3. 前端依赖问题
```bash
# 清理并重新安装前端依赖
cd frontend
rm -rf node_modules package-lock.json
npm install
cd ..
```

### 4. 构建失败
```bash
# 清理构建缓存
wails build --clean
```
