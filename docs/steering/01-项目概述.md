# DDSUViewer 项目概述

## 项目简介

DDSUViewer 是一个专为 DDSU666 单相电子式电能表设计的上位机软件，提供实时监控电参量数据的功能。该项目采用现代化的桌面应用开发技术栈，结合了 Go 语言的高性能后端处理能力和 React 的现代化前端界面。

## 项目背景

### 业务需求
- **实时监控**: 需要实时监控电压、电流、功率、频率等电参量
- **数据采集**: 通过 Modbus RTU 协议从 DDSU666 电能表采集数据
- **用户友好**: 提供直观的图形界面，方便操作人员使用
- **配置灵活**: 支持串口参数和从站地址的灵活配置

### 技术背景
- **协议标准**: 基于 Modbus RTU 工业通信协议
- **硬件接口**: 通过 RS485 串口与电能表通信
- **跨平台需求**: 需要在 Windows 环境下稳定运行

## 核心功能

### 1. 实时数据监控
- 电压 (V) - 寄存器地址: 0x2000
- 电流 (A) - 寄存器地址: 0x2002
- 有功功率 (W) - 寄存器地址: 0x2004
- 无功功率 (VAR) - 寄存器地址: 0x2006
- 视在功率 (VA) - 寄存器地址: 0x2008
- 功率因数 - 寄存器地址: 0x200A
- 频率 (Hz) - 寄存器地址: 0x200E
- 有功总电能 (kWh) - 寄存器地址: 0x4000

### 2. 通信管理
- 自动检测可用 COM 端口
- 支持多种波特率配置 (2400, 4800, 9600, 19200, 38400, 115200)
- 可配置数据位 (7, 8)、停止位 (1, 2)、校验位 (None, Even, Odd)
- 十六进制从站地址配置

### 3. 状态监控
- 连接状态实时显示
- 协议类型识别
- 错误信息提示
- 最后更新时间记录

## 技术架构

### 整体架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端界面      │    │   Wails桥接     │    │   Go后端服务    │
│   React + TS    │◄──►│   JavaScript    │◄──►│   业务逻辑      │
│   Chakra UI     │    │   绑定          │    │   串口通信      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                                       │
                                                       ▼
                                              ┌─────────────────┐
                                              │   硬件设备      │
                                              │   DDSU666      │
                                              │   电能表        │
                                              └─────────────────┘
```

### 技术栈详情

#### 后端技术栈
- **Go 1.23**: 主要编程语言，提供高性能和并发处理能力
- **Wails v2**: 桌面应用框架，提供前后端通信桥梁
- **go.bug.st/serial**: 串口通信库，处理 RS485 通信
- **自研 Modbus RTU**: 实现 Modbus RTU 协议栈

#### 前端技术栈
- **React 18**: 现代化前端框架
- **TypeScript**: 类型安全的 JavaScript 超集
- **Chakra UI v3**: 现代化 UI 组件库
- **Vite**: 快速的前端构建工具

## 项目结构

```
DDSUViewer/
├── docs/                     # 文档目录（设计/部署/设备手册等）
│   └── steering/             # 开发与运维技术指导文档
├── frontend/                 # 前端代码（React + TypeScript）
│   ├── src/
│   │   ├── components/       # 可复用的 React 组件（UI 控件、面板）
│   │   ├── hooks/            # 自定义 Hook（复用逻辑，如 toast service）
│   │   ├── store/            # 应用级状态管理（若使用）
│   │   ├── theme/            # 主题、样式变量和全局 CSS
│   │   └── index.tsx         # 前端入口
│   ├── public/               # 静态资源（图标、图片）
│   ├── package.json          # 前端依赖与脚本（npm run dev / build）
│   └── wailsjs/              # Wails 自动生成的前端 - 后端绑定文件
├── internal/                 # 后端内部包（业务实现）
│   ├── modbus/               # Modbus 协议实现与帧解析
│   ├── serial/               # 串口打开/读写封装（go.bug.st/serial）
│   ├── registers/            # 寄存器定义与寄存器映射表
│   ├── poller/               # 轮询器，定时读取设备数据
│   ├── service/              # 业务服务层（暴露给前端的 RPC）
│   ├── parser/               # 原始数据解析逻辑
│   └── protocol_detector/    # 协议检测或格式识别工具
├── cmd/ (可选)               # 若存在，放置可执行程序的子命令入口
├── app.go                    # Wails 应用初始化（绑定 RPC、窗口配置）
├── main.go                   # 程序主入口（启动流程）
├── wails.json                # Wails 构建与打包配置
├── build.ps1                 # Windows 下的构建脚本（统一版本号与打包）
├── upxbuild.ps1              # 支持 UPX 的压缩构建脚本
└── go.mod                    # Go 模块声明及依赖
```

## 开发环境要求

### 系统要求
- Windows 10/11 (64位)
- Go 1.23 或更高版本
- Node.js 16+ 和 npm
- Wails v2 CLI 工具

### 硬件要求
- 可用的 RS485 串口或 USB 转 RS485 适配器
- DDSU666 单相电子式电能表

## 版本信息

- **当前版本**: 0.0.8 (开发版)
- **目标版本**: 1.0.0 (正式版)
- **开发状态**: 活跃开发中

## 许可证

MIT License - 详见 LICENSE 文件